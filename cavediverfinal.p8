pico-8 cartridge // http://www.pico-8.com
version 32
__lua__
--cave diver
--by our class

function _init()
 game_over=false
 make_cave()
 make_player()
end

function _update()
	if (not game_over) then
		update_cave()
		move_player()
		check_hit()
	else
		if (btnp(5)) _init() --restart
	end
end

function _draw()
 cls()
 draw_cave()
 draw_player()

	if (game_over) then
  print("game over!",44,44,7)
  print("your score:"..player.score,34,54,7)
 	print("press ❎ to play again!",18,72,6)
 else
  print("score:"..player.score,2,2,7)
	end
end




-->8
function make_player()
player={}
  player.x=24
  player.y=60
  player.dy=0
  player.rise=1
  player.fall=2
  player.dead=3
  player.speed=2 --fly speed
  player.score=0
end
 function draw_player()
  if (game_over) then
   spr(player.dead,player.x,player.y)
  elseif (player.dy<0) then
   spr(player.rise,player.x,player.y)
  else
   spr(player.fall,player.x,player.y)
  end
end

function move_player()
  gravity=0.2 --bigger means more gravity!
  player.dy+=gravity --add gravity
  --jump
  if (btnp(2)) then
   player.dy-=5
   sfx(0)
  end
  --move to new position
  player.y+=player.dy
  
  --update score
  player.score+=player.speed
  
 end
 
function check_hit()
 for i=player.x,player.x+7 do
  if (cave[i+1].top>player.y
   or cave[i+1].btm<player.y+7) then
   game_over=true
   sfx(1)
 	end 
 end
end
-->8
function make_cave()
  cave={{["top"]=5,["btm"]=119}}
  top=45 --how low can the ceiling go?
  btm=85 --how high can the floor get?
end

function update_cave()
  --remove the back of the cave
 if (#cave>player.speed) then
  for i=1,player.speed do
   del(cave,cave[1])
		end
	end
  --add more cave
 while (#cave<128) do
  local col={}
  local up=flr(rnd(7)-3)
  local dwn=flr(rnd(7)-3)
  col.top=mid(3,cave[#cave].top+up,top)
  col.btm=mid(btm,cave[#cave].btm+dwn,124)
  add(cave,col)
	end 
end






function draw_cave()
 top_color=5 --play with these!
 btm_color=5 --choose your own colors!
 for i=1,#cave do
  line(i-1,0,i-1,cave[i].top,top_color)
  line(i-1,127,i-1,cave[i].btm,btm_color)
 end
end
__gfx__
00000000009aaa00009aaa0000888800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000009aaaa7009aaaa70028888e0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000009a0aa0aa9a0aa0aa28a88a88000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000009aaaaaaa9aaaaaaa28888888000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000009a0000aa9aa00aaa288aa888000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000009aa00aaa9aa00aaa28a88a88000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000009aaaaa009aaaaa002888880000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000009aaa00009aaa0000888800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__label__
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55577557755775777577755555757577755555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55755575557575757575555755757575755555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55777575557575775577555555777577755555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55557575557575757575555755557575755555555550505555555555555555555555555555555555555555555555555555555555555555555555555555555555
55775557757755757577755555557577755555555550005555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555550000555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555505000000055555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555500000000055555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555000000000055055555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555000000000005055555555555555555555555555555555555555555555555555555555555555555555555505555
55555555555555555555555555555555555550000000000000005500555555555555555555555555555555555555555555555555555555555555555550505555
55555555555555555555555555555555555550000000000000005500555005555555555555555000555555555555555555555555555555555555555550505555
55555555555555555555555555555555555500000000000000000000505005550055500555550000000005555555555555555555555555555555555550000555
55555555555555555555555555555555555500000000000000000000000000000055000555550000000005555555555555555555555555555555550000000555
55555555555555555555555555555555555500000000000000000000000000000005000005550000000005555555555555555555555555555555500000000505
55555555555555555555555555555555555000000000000000000000000000000000000005500000000000555555555555555555555555555555000000000000
55555505555055555555555055555555555000000000000000000000000000000000000000500000000000555555555555555555505555555555000000000000
55555005050055550555505055555555505000000000000000000000000000000000000000500000000000005555555555555555000555555555000000000000
05050005000055500055500000055555500000000000000000000000000000000000000000000000000000005555055555555555000555550050000000000000
05000000000000500005500000055555500000000000000000000000000000000000000000000000000000000055005555555550000505500000000000000000
00000000000000000005000000055555000000000000000000000000000000000000000000000000000000000005005550055550000000000000000000000000
00000000000000000005000000005000000000000000000000000000000000000000000000000000000000000000000050000550000000000000000000000000
00000000000000000000000000005000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000005000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000009aaa00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000009aaaa70000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000009a0aa0aa000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000009aaaaaaa000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000009a0000aa000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000009aa00aaa000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000009aaaaa0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000009aaa00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000005050555555000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000005550555555000000000000000000000000500000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000055555555555000000000000000000000000500000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000055555555555505050005000000000000005550000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000055555555555555550505500000050050005550000000000000000000000000000000005
00000000000000000000000000000000000000000000000000000000555555555555555555505500000555055005550000000000000000000000000000000005
00000000000000000000000000000000000000000000000000000505555555555555555555555500000555055055555000000000000000000000000000000005
00000000000000000000000000000000000000000000000000000505555555555555555555555555550555555055555000000000000000000000000000000055
00000000000000000000000000000000000000000000000000000555555555555555555555555555555555555555555000000000000000000000000000000555
00000000000000000000000000000000000000000000000500005555555555555555555555555555555555555555555500000000000000000000000000000555
00000000000000000000000000000000000000000000000500055555555555555555555555555555555555555555555500000000000000000000005005000555
00000000000000000000000000000000000000000000005550055555555555555555555555555555555555555555555500000000000000000000005005505555
00000000000000000000000000000000000000000000005550555555555555555555555555555555555555555555555550000000000000000000505055505555
00000000000000000000000000000000000000000000055555555555555555555555555555555555555555555555555550000000050000000000555555555555
00000000000000000000000000000000000000000000555555555555555555555555555555555555555555555555555550000000050000000005555555555555
00000000000000000000000000000000000000000000555555555555555555555555555555555555555555555555555555050000550000000005555555555555
00000000000000000000000000000000000000000000555555555555555555555555555555555555555555555555555555055000555000000005555555555555
00000000000000000000000000000000000000000005555555555555555555555555555555555555555555555555555555055505555500000055555555555555
00000000000000000000000000000000000000000005555555555555555555555555555555555555555555555555555555555505555555000055555555555555
00000000000000000000000000000000000000000055555555555555555555555555555555555555555555555555555555555555555555000055555555555555
00000000000000000000000000000000000000000055555555555555555555555555555555555555555555555555555555555555555555000555555555555555
00000000000000000005000000000000000000000555555555555555555555555555555555555555555555555555555555555555555555505555555555555555
00000000000000000005000000000000000000000555555555555555555555555555555555555555555555555555555555555555555555505555555555555555
00000000000000000005500000000000000000005555555555555555555555555555555555555555555555555555555555555555555555505555555555555555
00000000000000000055500000000000000000055555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
00000000000000000055500000000000000000055555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
00000000000000005055550050000000000000055555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
00000000000500505555550550505000500000555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
00000000505550555555550555505000505000555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
00000000505555555555555555505005505005555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
00000050555555555555555555555505555055555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
00000055555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
00000055555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
00000555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
00000555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
00000555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
00005555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
00005555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
00055555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555

__sfx__
00040000190501d050000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000a0000320500000027050000001d050000000b0500b0500b0500b0500b050000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
